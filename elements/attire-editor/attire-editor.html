<html><head><link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../scripts/behaviors/busListenerBehavior.html">
<link rel="import" href="../../scripts/behaviors/permissionsBehavior.html">
<link rel="import" href="../../scripts/behaviors/localizationBehavior.html">
<link rel="import" href="../../scripts/behaviors/loaderBehavior.html">

</head><body><dom-module id="attire-editor">
  <template>
    <style>
      .button-tooltip {
        font-size: 15px;
        width: 150px;
        text-align: center;
      }

      .buttons {
        position: absolute;
        right: 0;
      }

      .content {
        margin-top: 20px;
        margin-left: 20px;
        height: 80vh;
        overflow: scroll;
        overflow-x: hidden;
      }

      .no-attires {
        color: cornflowerblue;
      }

      .rules-container {
        margin-left: 30px;
      }

      .balls-input {
        display: inline-block;
        width: 50px;
      }

      .remove-rule-button {
        margin-left: 10px;
      }

      .load-button {
        margin-left: 30px;
      }

      /* @faloi:
      Esto no debería ser necesasrio, pero por algún motivo no importa los estilos del paper-dialog. */
      paper-button.boton {
        display: var(--layout-inline_-_display);
        -ms-flex-align: var(--layout-center-center_-_-ms-flex-align);
        -webkit-align-items: var(--layout-center-center_-_-webkit-align-items);
        align-items: var(--layout-center-center_-_align-items);
        -ms-flex-pack: var(--layout-center-center_-_-ms-flex-pack);
        -webkit-justify-content: var(--layout-center-center_-_-webkit-justify-content);
        justify-content: var(--layout-center-center_-_justify-content);
        position: relative;
        box-sizing: border-box;
        min-width: 5.14em;
        margin: 0 0.29em;
        background: transparent;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        -webkit-tap-highlight-color: transparent;
        font: inherit;
        text-transform: uppercase;
        outline-width: 0;
        border-radius: 3px;
        -moz-user-select: none;
        -ms-user-select: none;
        -webkit-user-select: none;
        user-select: none;
        cursor: pointer;
        z-index: 0;
        padding: 0.7em 0.57em;
        font-family: var(--paper-font-common-base_-_font-family);
        -webkit-font-smoothing: var(--paper-font-common-base_-_-webkit-font-smoothing);
      }
    </style>

    <!-- @faloi: importo los iconos que necesito a mano, porque el import del set no me anduvo  -->
    <iron-iconset-svg name="editor" size="24">
      <svg>
        <defs>
          <g id="text-fields">
            <path d="M2.5 4v3h5v12h3V7h5V4h-13zm19 5h-9v3h3v7h3v-7h3V9z"></path>
          </g>
        </defs>
      </svg>
    </iron-iconset-svg>

    <iron-iconset-svg name="image" size="24">
      <svg>
        <defs>
          <g id="image">
            <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"></path>
          </g>
        </defs>
      </svg>
    </iron-iconset-svg>

    <div class="buttons">
      <paper-button id="add-attire-button" style="z-index: 99" on-click="addAttire"><iron-icon class="black-button" icon="icons:add"></iron-icon></paper-button>
      <paper-tooltip for="add-attire-button" position="bottom" animation-config="{{tooltipAnimation}}">
        <div class="button-tooltip">
          [[localize("attire-editor-tooltip-add-attire")]]
        </div>
      </paper-tooltip>

      <paper-button id="remove-attire-button" style="z-index: 99" on-click="removeAttire"><iron-icon class="black-button" icon="icons:remove"></iron-icon></paper-button>
      <paper-tooltip for="remove-attire-button" position="bottom" animation-config="{{tooltipAnimation}}">
        <div class="button-tooltip">
          [[localize("attire-editor-tooltip-remove-attire")]]
        </div>
      </paper-tooltip>
    </div>

    <input id="image" type="file" accept=".png,.gif" on-change="onLoadedImage" style="visibility: hidden;">

    <div class="content">
      <template is="dom-if" if="{{attire}}">
        <div>
          <span><strong>[[localize("attire")]]:</strong> <i>[[attire.name]]</i> <paper-button id="rename-attire-button" style="z-index: 99" on-click="renameAttire"><iron-icon class="black-button" icon="icons:create"></iron-icon></paper-button></span>
          <paper-tooltip for="rename-attire-button" position="bottom" animation-config="{{tooltipAnimation}}">
            <div class="button-tooltip">
              [[localize("attire-editor-tooltip-rename-attire")]]
            </div>
          </paper-tooltip>
          <br>

          <hr>
          <br>

          <div>
            <paper-button id="add-rule-button" style="z-index: 99" on-click="addRule"><iron-icon class="black-button" icon="icons:add"></iron-icon></paper-button>
            <paper-tooltip for="add-rule-button" position="right" animation-config="{{tooltipAnimation}}">
              <div class="button-tooltip">
                [[localize("attire-editor-tooltip-add-rule")]]
              </div>
            </paper-tooltip>
          </div>

          <div class="rules-container">
            <template is="dom-repeat" items="{{ attire.rules }}">
              <paper-button style="z-index: 99" on-click="upRule"><iron-icon class="black-button" icon="icons:arrow-drop-up"></iron-icon></paper-button>

              <paper-button style="z-index: 99; margin-right: 10px" on-click="downRule"><iron-icon class="black-button" icon="icons:arrow-drop-down"></iron-icon></paper-button>

              <img src="../../images/stones/red.svg" width="15" height="15">
              <paper-input class="balls-input" type="text" pattern="[0-9]+|\*|\+" auto-validate="" value="{{item.when.red}}" on-input="_update"></paper-input>

              <img src="../../images/stones/green.svg" width="15" height="15">
              <paper-input class="balls-input" type="text" pattern="[0-9]+|\*|\+" auto-validate="" value="{{item.when.green}}" on-input="_update"></paper-input>

              <img src="../../images/stones/blue.svg" width="15" height="15">
              <paper-input class="balls-input" type="text" pattern="[0-9]+|\*|\+" auto-validate="" value="{{item.when.blue}}" on-input="_update"></paper-input>

              <img src="../../images/stones/black.svg" width="15" height="15">
              <paper-input class="balls-input" type="text" pattern="[0-9]+|\*|\+" auto-validate="" value="{{item.when.black}}" on-input="_update"></paper-input>

              <paper-button class="remove-rule-button" style="z-index: 99" on-click="removeRule"><iron-icon class="black-button" icon="icons:delete-forever"></iron-icon></paper-button>

              <paper-icon-button class="load-button" on-click="loadImage" icon="image:image" alt="open"> </paper-icon-button>

              <template is="dom-if" if="{{item.fileName}}">
                <i>[[item.fileName]]</i>
              </template>

              <template is="dom-if" if="{{!item.fileName}}">
                <span>/</span>
                <iron-icon icon="editor:text-fields"></iron-icon>
                <paper-input class="balls-input" value="{{item.text}}" on-input="_update" maxlength="2" char-counter=""></paper-input>
              </template>

              <br>
            </template>
          </div>
        </div>
      </template>

      <template is="dom-if" if="{{!attire}}">
        <h3 class="no-attires">[[localize("attire-editor-add-new-attires")]]</h3>
      </template>
    </div>
  </template>

  </dom-module>
<script src="attire-editor.js"></script></body></html>